---
export interface Props {
	youtube_id: string;
	title?: string;
	autoplay: boolean;
}

const { youtube_id, title, autoplay = false } = Astro.props;
---

<lite-youtube
	videoid={youtube_id}
	playlabel={title ? `Play: ${title}` : undefined}
	js-api></lite-youtube>

<script>
	import 'lite-youtube-embed';
	import 'lite-youtube-embed/src/lite-yt-embed.css';
</script>

<script define:vars={{ autoplay }}>
	const init = async () => {
		const el = document.querySelector('lite-youtube');

		if (!autoplay || !el) {
			return;
		}
		// @ts-expect-error
		const player = await el.getYTPlayer();

		if (!player) {
			return;
		}

		player.playVideo();
	};

	document.addEventListener('astro:after-swap', init);
</script>

<style>
	lite-youtube {
		aspect-ratio: 16 / 9;
		block-size: 100cqb;
		margin-inline: auto;
		max-inline-size: 100dvi;
	}
</style>
